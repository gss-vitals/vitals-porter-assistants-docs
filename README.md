# Porter小幫手 說明手冊
#### 適用版本：2.0.2
## 關於Porter小幫手
> 雖然 Vitals ESP Porter 可以讓客戶自 Vitals ESP 網站匯入或匯出中介資料，但有些使用者仍然需要在匯入前先做中介資料的檢視與編輯, 這就是為何 Porter 小幫手會誔生的原因。

---

## 如何使用本文件?
* 首先，如果你在 Excel 看到類似以下的警告畫面,請啟用 Excel 的巨集功能,因為 Porter 小幫手需要使用巨集功能來分析及處理 Porter 所匯出的中介資料。

  ![macroAlert.png](/img/macroAlert.png)
  ![macroAlertPrompt.png](/img/macroAlertPrompt.png)

* 你可以將此 Excel 直接置於 Porter 的工作目錄(Metadata)下,或於基本設定工作表中，設定要處理中介資料的位置。

* 每一個資源工作表對應至中介資料的資源類型,大多工作表有４個功能按鈕，說明如下圖：
    ![mainButtons.png](/img/mainButtons.png)

    #### 匯入
    * 自中介資料資料夾讀入並分析Json格式中介資料，若有任何錯誤發生，將會顯示在訊息儲存格。

    #### 匯出
    * 分析並序列化資源工作表的資料為Json格式的中介資料寫入至中介資料夾，若有任何錯誤發生，將會顯示在訊息儲存格。

    #### 格式化內容
    * 當您按下"格式化內容"，Porter小幫手將嘗試替您所輸入的資料格式化為指定的格式並建立資料驗證準則(如下拉選單)。
    * 將欄位依照知識類型欄位型別，更改Excel欄位運作方式，如補充可下拉選單的欄位。

    #### 清除內容
    * 清除目前資源工作表的所有資料內容。

* 另外在知識文件的工作表有額外的3個功能按鈕：

    #### 實體附檔檢查
    * 檢查附檔來源欄位，裡面的檔案路徑是否都存在，並且，如果是填資料夾路徑則會自動轉換成那個資料夾內所有檔案的絕對路徑。
    #### 必填欄位檢查
    * 檢查所有必填欄位是否有填寫。如果有必填欄位沒有填寫，Porter小幫手會跳出提示，指出檢查到的第一個未填寫欄位提示需要填寫，但文件標題欄位無法被檢查。
    #### 產生範例
    * 在最上方產生三列知識文件的填寫範例，會根據知識類型欄位產生對應類型的範例。

---

## Porter小幫手能做些什麼?
Porter小幫手能：
* 匯入或匯出 **`使用者`** 資源
* 匯入或匯出 **`知識類型`** 資源(需一併處理知識類型欄位工作表)
* 匯入或匯出 **`分類夾`** 資源
* 匯入或匯出 **`文件夾`** 資源
* 匯入或匯出 **`文件`** 資源(每次僅能處理一種知識類型的文件)

## Porter小幫手不能做些什麼?
Porter小幫手不能：
* 匯入或匯出 JSON 以外的中介資料格式
* 匯入或匯出使用者的密碼
* 匯入或匯出 `角色/單位組織/群組` 資源
* 匯入或匯出 文件夾/分類夾之路徑屬性包含檔案系統之不合法字元(例如: `[<>:|"?*\\t]` )
* 變更根文件夾的權限

---

## 如何設定文件夾權限 ?
文件夾權限的設定格式為：
> LOGINID:SUBJECTTYPE=FLAG
> 
> {SUBJECTID}:SUBJECTTYPE=FLAG
* LOGINID: 使用者的登入帳號
* SUBJECTID: 使用者/單位組織/群組的SubjecId,以中括號包起來
* SUBJECTTYPE:
  | Flag | 代表主體 |
  |:-------------:| ----- |
  | 0 | 使用者 |
  | 1 | 單位組織 |
  | 2 | 群組 |
  | 3 | 角色 |
* FLAG: 你可以混合這些FLAG，例如：當設定為FLAG為5則表示可以檢視及更新文件夾
    | Flag | 權限內容 |
    |:-:| --------- |
    | 1 | 檢視文件夾 |
    | 2 | 建立子文件夾 |
    | 4 | 更新文件夾 |
    | 8 | 刪除文件夾 |
    | 16 | 新增文件 |
    | 32 | 刪除文件 |
    | 64 | 管理文件夾 |
    * 你能設定多個權限，只需將這些權限以","分隔開，例如：admin:0=63,{ae7b7c21-fbe5-459a-af75-3b73b3fab283}:1=1

## 如何設定(預設)文件權限 ?
* 文件權限格式設定與文件夾權限相同，但FLAG的意義不太相同
* FLAG: (你可以混合這些FLAG,例如，當設定為FLAG為5則表示可以檢視及列印文件 )
    | Flag | 權限內容 |
    |:-:| --------- |
    | 1 | 檢視文件 |
    | 2 | 更新文件 |
    | 4 | 列印文件 |
    | 8 | 討論文件 |
    | 16 | 下載附檔 |
    | 32 | 預覧附檔 |
    | 64 | 管理文件 |

## 如何填寫欄位介面?
* 知識類型欄位的欄位介面對應如下：
    | 填寫內容 | 對應欄位 |
    |:-:| --------- |
    | TEXTBOX | 單行文字方塊 |
    | TEXTAREA | 多行文字方塊 |
    | RICHTEXT | 豐富文字編輯器 |
    | DATETIME | 日期與時間文字方塊 |
    | CALENDAR | 日期格式文字方塊 |
    | CHECKLIST | 多勾選 |
    | RADIO | 單選按鈕 |
    | DROPDOWN | 下拉式選單 |
    | SUBJECT | 選擇成員 |
* 編號規則欄位介面目前不支援
* 欄位介面項目：只有需要選擇選項的欄位(**`CHECKLIST`**，**`RADIO`**，**`DROPDOWN`**，**`SUBJECT`**)需要填寫，在這些欄位中填入可以選擇的選項，並以 **"|"** 作為選項之間的分隔符號，例如：`選項A|選項B|選項C`。
* **SUBJECT**的欄位介面項目，選項必須是SUBJECT ID，也可以不填選項，但是產生範例就不會出現此欄位的範例

## 如何填寫多選欄位
對於可以複選的欄位，請用逗號(**","**)分隔多個選項，例如有選項`A、B、C、D`，若想選擇B和C，請填入`B,C`

## 如何填寫文件夾和分類夾路徑
* 在**文件夾**和**分類夾**工作表：
    * 文件夾路徑：請填入文件夾的**上一層**文件夾路徑，並在**名稱**欄位填入文件夾名稱
    * 分類夾路徑：請填入分類夾的**上一層**分類夾路徑，並在**名稱**欄位填入分類夾名稱
    * 特殊情境：
        * 路徑欄位中包含不存在的資料夾或分類夾：匯出時也會自動產生相關的中介資料
        * 若要表達最上層根目錄，路徑欄位請填 **`../`**
        * 路徑或名稱有包含`/`：請改以 **`%2F`** 表示
        * 路徑或名稱有包含`,`，請改以 **`%2C`** 表示
        * 路徑或名稱不可包含以下特殊字元：`[<>:|"?*\\t]`

* 在**知識文件**工作表：
    * 文件夾路徑：有下拉選單可以選取，請填入**完整**文件夾路徑
    * 分類夾路徑：請填入**完整**分類夾路徑，若需要填寫多個分類夾，請用逗號(**","**)分隔多個路徑


## 如何匯入暨存的文件中介資料至文件資源工作表?
* 因為**知識文件**的中介資料較複雜，所以限制一次只能處理一種知識類型的文件
* 如果要處理Porter所匯出的文件中介資料：
    1. 請先匯入"**知識類型**"及"**知識類型欄位**"
    2. 再於"**知識文件**"工作表選擇這次您想要處理的知識類型
    3. 按下"**匯入**"功能按鈕
    4. 最後，您應該就可以成功檢視自Porter匯出的知識文件了

---

## 備註
* 所有的**路徑**欄位皆以"/"分隔，表示是Vitals ESP系統的路徑，如果文件夾名稱有包含`/`，請改以 **`%2F`** 表示
* 若路徑名稱中有包含了特殊字元，例如：`[<>:|"?*\\t]`，可能會造成Porter小幫手無法正確地處理
* 若包含多個路徑，例如文件附檔，則以","分隔，若路徑中包含`,`，請改以 **`%2C`** 表示
* 知識類型欄位如果是日期且希望使用系統日期，請在預設值填 **`default`**
* 知識文件在格式化時會自動將空白的必填欄位填入預設值，除了預設使用系統日期的欄位仍需手動填入日期
* 因為Excel VBA中long型態的限制(-2,147,483,648 to 2,147,483,647)，能夠轉換的日期範圍(文件建立/生效/失效日)為 `02/13/1901 20:45:52` 至 `01/19/2038 03:14:07`
* 格式化產生下拉選單會到當前填寫行數的後5行，如果填到後面發現沒有下拉選單可以選，請再按一次格式化